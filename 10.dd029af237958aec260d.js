(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{G81l:function(e,t,i){"use strict";i.r(t),i.d(t,"ManufacturingModule",function(){return ee});var c=i("ofXK"),n=i("tyNb"),r=i("20UA"),o=i("fXoL"),s=i("K3ix"),a=i("3Pt+"),d=i("44PX");function m(e){return new r.q({orderId:e.order.id,items:[]})}class b{constructor(e,t){this.orderPart=e,this.member=t,this.clientName=e.order.client.name,this.incompleteItemsCount=e.incompleteItems.filter(e=>e.amount>0).length,this.memberItemsCount=(null==t?void 0:t.items.filter(e=>e.amount>0).length)||0,this.date=e.order.requestedDate.toLocaleDateString("hu-hu"),this.items=e.incompleteItems.map(e=>{var i;return{recipeId:e.recipe.id,recipeName:e.recipe.name,incompleteAmount:e.amount,memberAmount:(null===(i=null==t?void 0:t.items.find(t=>t.recipeId===e.recipe.id))||void 0===i?void 0:i.amount)||0}})}}var l=i("FrXe"),h=i("fU1k");function p(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",5),o.Tb(1,"div",6),o.Cc(2),o.Sb(),o.Tb(3,"div",7),o.Cc(4),o.Sb(),o.Tb(5,"div",8),o.Tb(6,"app-add-check",9),o.ac("checkedChange",function(t){o.vc(e);const i=o.ec().$implicit;return o.ec().onOrderChecked(t,i)}),o.Sb(),o.Sb(),o.Sb()}if(2&e){const e=o.ec().$implicit;o.Bb(2),o.Fc("",e.clientName," (",e.date,")"),o.Bb(2),o.Fc("",e.memberItemsCount," / ",e.incompleteItemsCount,""),o.Bb(2),o.kc("checked",e.memberItemsCount>0)}}function u(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",5),o.Tb(1,"div",11),o.Cc(2),o.Sb(),o.Tb(3,"div",12),o.Tb(4,"div",13),o.Tb(5,"input",14),o.ac("ngModelChange",function(e){return t.$implicit.memberAmount=e})("ngModelChange",function(){o.vc(e);const t=o.ec(2).$implicit;return o.ec().change(t)}),o.Sb(),o.Sb(),o.Tb(6,"div",15),o.Cc(7),o.Sb(),o.Sb(),o.Tb(8,"div",8),o.Tb(9,"app-add-check",9),o.ac("checkedChange",function(i){o.vc(e);const c=t.$implicit,n=o.ec(2).$implicit;return o.ec().onItemChecked(i,c,n)}),o.Sb(),o.Sb(),o.Sb()}if(2&e){const e=t.$implicit;o.Bb(2),o.Ec(" ",e.recipeName," "),o.Bb(3),o.kc("ngModel",e.memberAmount)("max",e.incompleteAmount),o.Bb(2),o.Ec(" / ",e.incompleteAmount,""),o.Bb(2),o.kc("checked",e.memberAmount>0)}}function g(e,t){if(1&e&&o.Ac(0,u,10,5,"div",10),2&e){const e=o.ec().$implicit,t=o.ec();o.kc("ngForOf",t.itemsFiltered(e))}}function f(e,t){1&e&&(o.Tb(0,"app-tree-node",2),o.Ac(1,p,7,5,"ng-template",null,3,o.Bc),o.Ac(3,g,1,1,"ng-template",null,4,o.Bc),o.Sb()),2&e&&o.kc("collapsed",!1)}let v=(()=>{class e{constructor(){this.mixingBatchMembersByOrderId=new Map,this.mixingBatchOrders=new Array,this.orderSelected=new o.n}ngOnInit(){}itemsFiltered(e){return e.items.filter(e=>e.memberAmount>0)}onItemChecked(e,t,i){i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId);const c=new b(i.orderPart,i.member);this.orderSelected.emit(c)}onOrderChecked(e,t){t.member=m(t.orderPart);const i=new b(t.orderPart,t.member);this.orderSelected.emit(i)}change(e){e.member.items.forEach(t=>t.amount=e.items.find(e=>e.recipeId==t.recipeId).memberAmount),this.orderSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Hb({type:e,selectors:[["app-batch-content"]],inputs:{mixingBatchMembersByOrderId:"mixingBatchMembersByOrderId",mixingBatchOrders:"mixingBatchOrders"},outputs:{orderSelected:"orderSelected"},decls:2,vars:1,consts:[[1,"p-2"],[3,"collapsed",4,"ngFor","ngForOf"],[3,"collapsed"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-6"],[1,"col-4"],[1,"col-2"],[3,"checked","checkedChange"],["class","row  align-items-center",4,"ngFor","ngForOf"],[1,"col-5"],[1,"col-5","d-flex","flex-nowrap","align-items-center"],[2,"width","6rem"],["min","1",1,"form-control",3,"ngModel","max","ngModelChange"],[1,"row","m-2"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Ac(1,f,5,1,"app-tree-node",1),o.Sb()),2&e&&(o.Bb(1),o.kc("ngForOf",t.mixingBatchOrders))},directives:[c.k,l.a,h.a,a.b,a.h,a.j],styles:[""]}),e})();function S(e,t){if(1&e&&(o.Tb(0,"div",5),o.Tb(1,"div",6),o.Cc(2),o.Sb(),o.Tb(3,"div",7),o.Cc(4),o.Sb(),o.Tb(5,"div",8),o.Cc(6),o.Sb(),o.Sb()),2&e){const e=o.ec().$implicit;o.Bb(2),o.Dc(e.recipeName),o.Bb(2),o.Ec("",e.totalAmount," adag"),o.Bb(2),o.Ec("",e.totalClients," megrendel\xe9s")}}function B(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",5),o.Tb(1,"div",6),o.Cc(2),o.Sb(),o.Tb(3,"div",7),o.Cc(4),o.Sb(),o.Tb(5,"div",8),o.Tb(6,"app-add-check",10),o.ac("checkedChange",function(i){o.vc(e);const c=t.$implicit,n=o.ec(2).$implicit;return o.ec().onItemChecked(i,n.recipeId,c.order)}),o.Sb(),o.Sb(),o.Sb()}if(2&e){const e=t.$implicit;o.Bb(2),o.Ec(" ",e.order.clientName," "),o.Bb(2),o.Ec(" ",e.item.memberAmount," adag"),o.Bb(2),o.kc("checked",!0)}}function C(e,t){if(1&e&&o.Ac(0,B,7,3,"div",9),2&e){const e=o.ec().$implicit;o.kc("ngForOf",e.items)}}function k(e,t){1&e&&(o.Tb(0,"app-tree-node",2),o.Ac(1,S,7,3,"ng-template",null,3,o.Bc),o.Ac(3,C,1,1,"ng-template",null,4,o.Bc),o.Sb()),2&e&&o.kc("collapsed",!1)}let T=(()=>{class e{constructor(){this.orderSelected=new o.n,this.recipeDeselected=new o.n}set mixingBatchOrders(e){this.recipes=this.toInternalRepresentation(e)}toInternalRepresentation(e){const t=new Map;return e.forEach(e=>e.items.forEach(i=>{if(i.memberAmount>0)if(t.get(i.recipeId)){const c=t.get(i.recipeId);c.totalAmount+=i.memberAmount,c.totalClients+=1,c.items.push({item:e.items.find(e=>e.recipeId===i.recipeId),order:e})}else t.set(i.recipeId,{recipeName:i.recipeName,recipeId:i.recipeId,totalAmount:i.memberAmount,completedAmount:0,totalClients:1,items:[{item:e.items.find(e=>e.recipeId===i.recipeId),order:e}]})})),[...t.values()]}ngOnInit(){}onRecipeRemoved(e){this.recipeDeselected.emit(e)}onItemChecked(e,t,i){i.member.items=i.member.items.filter(e=>e.recipeId!==t);const c=new b(i.orderPart,i.member);this.orderSelected.emit(c)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Hb({type:e,selectors:[["app-batch-overview"]],inputs:{mixingBatchOrders:"mixingBatchOrders"},outputs:{orderSelected:"orderSelected",recipeDeselected:"recipeDeselected"},decls:2,vars:1,consts:[[1,"p-2"],[3,"collapsed",4,"ngFor","ngForOf"],[3,"collapsed"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-5"],[1,"col-3"],[1,"col-4"],["class","row  align-items-center",4,"ngFor","ngForOf"],[3,"checked","checkedChange"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Ac(1,k,5,1,"app-tree-node",1),o.Sb()),2&e&&(o.Bb(1),o.kc("ngForOf",t.recipes))},directives:[c.k,l.a,h.a],styles:[""]}),e})();var I=i("vkgz"),O=i("lJxs"),y=i("gcYM"),x=i("5+tZ"),w=i("Kqap"),M=i("2Vo4"),A=i("XNiG"),F=i("vxfF"),N=i("psEu");function j(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",18),o.Tb(1,"div",19),o.Cc(2),o.Sb(),o.Tb(3,"div",20),o.Cc(4),o.Sb(),o.Tb(5,"div",20),o.Tb(6,"app-add-check",21),o.ac("checkedChange",function(t){o.vc(e);const i=o.ec().$implicit;return o.ec(2).onOrderChecked(t,i)}),o.Sb(),o.Sb(),o.Sb()}if(2&e){const e=o.ec().$implicit;o.Bb(2),o.Fc("",e.clientName," (",e.date,")"),o.Bb(2),o.Fc("",e.memberItemsCount," / ",e.incompleteItemsCount,""),o.Bb(2),o.kc("checked",e.memberItemsCount>0)}}function D(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",18),o.Tb(1,"div",19),o.Cc(2),o.Sb(),o.Tb(3,"div",20),o.Cc(4),o.Sb(),o.Tb(5,"div",20),o.Tb(6,"app-add-check",21),o.ac("checkedChange",function(i){o.vc(e);const c=t.$implicit,n=o.ec(2).$implicit;return o.ec(2).onItemChecked(i,c,n)}),o.Sb(),o.Sb(),o.Sb()}if(2&e){const e=t.$implicit;o.Bb(2),o.Ec(" ",e.recipeName," "),o.Bb(2),o.Fc(" ",e.memberAmount," / ",e.incompleteAmount," "),o.Bb(2),o.kc("checked",e.memberAmount>0)}}function $(e,t){if(1&e&&o.Ac(0,D,7,4,"div",22),2&e){const e=o.ec().$implicit;o.kc("ngForOf",e.items)}}function E(e,t){1&e&&(o.Tb(0,"app-tree-node"),o.Ac(1,j,7,5,"ng-template",null,16,o.Bc),o.Ac(3,$,1,1,"ng-template",null,17,o.Bc),o.Sb())}function P(e,t){if(1&e){const e=o.Ub();o.Rb(0,13),o.Tb(1,"cdk-virtual-scroll-viewport",14),o.ac("scrolledIndexChange",function(i){o.vc(e);const c=t.ngIf;return o.ec().nextBatch(i,c.length)}),o.Ac(2,E,5,0,"app-tree-node",15),o.Sb(),o.Qb()}if(2&e){const e=t.ngIf;o.Bb(1),o.kc("itemSize",200),o.Bb(1),o.kc("cdkVirtualForOf",e)}}let R=(()=>{class e{constructor(e){this.ordersClient=e,this.batch=10,this.theEnd=!1,this.offset=new M.a(0),this.orderSelected=new o.n,this.itemsDisplayedSubject=new A.a,this.itemsDisplayedObservable=this.itemsDisplayedSubject.asObservable()}ngOnInit(){this.reset()}getBatch(e){return this.ordersClient.searchForMixing(this.from,this.to,this.clientName,this.recipeName,e,this.batch).pipe(Object(I.a)(e=>this.theEnd=!e.hasMore),Object(O.a)(e=>e.content.map(e=>new b(e,this.mixingBatchMembersByOrderId.get(e.order.id)))))}nextBatch(e,t){this.theEnd||this.viewport.getRenderedRange().end===this.viewport.getDataLength()&&this.offset.next(t)}filterChange(){this.reset()}onItemChecked(e,t,i){e?(i.member?i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId):i.member=m(i.orderPart),i.member.items.push(new r.p({recipeId:t.recipeId,amount:t.incompleteAmount}))):i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId);const c=new b(i.orderPart,i.member);this.itemsDisplayed[this.itemsDisplayed.indexOf(i)]=c,this.itemsDisplayedSubject.next([...this.itemsDisplayed]),this.orderSelected.emit(c)}onOrderChecked(e,t){var i;t.member=e?new r.q({orderId:(i=t.orderPart).order.id,items:i.incompleteItems.map(e=>new r.p({recipeId:e.recipe.id,amount:e.amount}))}):m(t.orderPart);const c=new b(t.orderPart,t.member);this.itemsDisplayed[this.itemsDisplayed.indexOf(t)]=c,this.itemsDisplayedSubject.next([...this.itemsDisplayed]),this.orderSelected.emit(c)}reset(){this.offset=new M.a(0),this.offset.pipe(Object(y.a)(500),Object(x.b)(e=>this.getBatch(e)),Object(w.a)((e,t)=>e.concat(t),[])).pipe(Object(I.a)(e=>this.itemsDisplayed=e),Object(I.a)(e=>this.itemsDisplayedSubject.next(e))).subscribe(),this.offset.next(0)}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(r.y))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-select-orders"]],viewQuery:function(e,t){if(1&e&&o.Jc(F.c,1),2&e){let e;o.sc(e=o.bc())&&(t.viewport=e.first)}},inputs:{mixingBatchMembersByOrderId:"mixingBatchMembersByOrderId",batchChanged:"batchChanged"},outputs:{orderSelected:"orderSelected"},decls:25,vars:13,consts:[["type","info"],[1,"d-flex","row"],[1,"form-group","col-lg-6"],["for","from",1,"form-label"],["id","from","type","date",1,"form-control",3,"ngModel","ngModelChange"],["for","to",1,"form-label"],["id","to","type","date",1,"form-control",3,"ngModel","ngModelChange"],["for","clientName",1,"form-label"],["id","clientName","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","recipeName",1,"form-label"],["id","recipeName","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"card","bg-primary","p-2"],["style","height: 80vh",4,"ngIf"],[2,"height","80vh"],[2,"height","80vh",3,"itemSize","scrolledIndexChange"],[4,"cdkVirtualFor","cdkVirtualForOf"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-6"],[1,"col-3"],[3,"checked","checkedChange"],["class","row  align-items-center",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(o.Tb(0,"alert",0),o.Cc(1,"Keres\xe9s kisz\xe1ll\xedt\xe1si d\xe1tum szerint t\xf3l/ig"),o.Ob(2,"br"),o.Tb(3,"div",1),o.Tb(4,"div",2),o.Tb(5,"label",3),o.Cc(6,"Kisz\xe1ll\xedt\xe1s d\xe1tuma: "),o.Sb(),o.Tb(7,"input",4),o.ac("ngModelChange",function(e){return t.from=e,t.filterChange()}),o.fc(8,"date"),o.Sb(),o.Sb(),o.Tb(9,"div",2),o.Tb(10,"label",5),o.Cc(11," - "),o.Sb(),o.Tb(12,"input",6),o.ac("ngModelChange",function(e){return t.to=e,t.filterChange()}),o.fc(13,"date"),o.Sb(),o.Sb(),o.Tb(14,"div",2),o.Tb(15,"label",7),o.Cc(16," Fagyiz\xf3: "),o.Sb(),o.Tb(17,"input",8),o.ac("ngModelChange",function(){return t.filterChange()})("ngModelChange",function(e){return t.clientName=e}),o.Sb(),o.Sb(),o.Tb(18,"div",2),o.Tb(19,"label",9),o.Cc(20," Recept: "),o.Sb(),o.Tb(21,"input",10),o.ac("ngModelChange",function(){return t.filterChange()})("ngModelChange",function(e){return t.recipeName=e}),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Tb(22,"div",11),o.Ac(23,P,3,2,"ng-container",12),o.fc(24,"async"),o.Sb()),2&e&&(o.Bb(7),o.kc("ngModel",o.hc(8,5,t.from,"yyyy-MM-dd")),o.Bb(5),o.kc("ngModel",o.hc(13,8,t.to,"yyyy-MM-dd")),o.Bb(5),o.kc("ngModel",t.clientName),o.Bb(4),o.kc("ngModel",t.recipeName),o.Bb(2),o.kc("ngIf",o.gc(24,11,t.itemsDisplayedObservable)))},directives:[N.a,a.b,a.h,a.j,c.l,F.c,F.a,F.b,l.a,h.a,c.k],pipes:[c.e,c.b],styles:[""]}),e})();function U(e,t){if(1&e){const e=o.Ub();o.Tb(0,"app-select-orders",15),o.ac("orderSelected",function(t){return o.vc(e),o.ec().orderSelected(t)}),o.Sb()}if(2&e){const e=o.ec();o.kc("mixingBatchMembersByOrderId",e.mixingBatchMembersByOrderId)}}const L=function(e){return{"table-warning":e}};function z(e,t){if(1&e&&(o.Tb(0,"tr",21),o.Tb(1,"td"),o.Cc(2),o.Sb(),o.Tb(3,"td"),o.Cc(4),o.Sb(),o.Tb(5,"td"),o.Cc(6),o.Sb(),o.Sb()),2&e){const e=t.$implicit;o.kc("ngClass",o.oc(6,L,e.amountRequired!==e.ingredient.amountOnHand)),o.Bb(2),o.Dc(e.ingredient.name),o.Bb(2),o.Fc("",e.amountRequired," ",e.ingredient.measurementUnit,""),o.Bb(2),o.Fc("",e.ingredient.amountOnHand," ",e.ingredient.measurementUnit,"")}}function H(e,t){if(1&e&&(o.Tb(0,"tbody"),o.Ac(1,z,7,8,"tr",20),o.Sb()),2&e){const e=o.ec(2);o.Bb(1),o.kc("ngForOf",e.ingredientList)}}function K(e,t){if(1&e&&(o.Ob(0,"div",16),o.Tb(1,"div",17),o.Tb(2,"table",18),o.Tb(3,"thead"),o.Tb(4,"tr"),o.Tb(5,"th"),o.Cc(6,"Alapanyag"),o.Sb(),o.Tb(7,"th"),o.Cc(8,"Sz\xfcks\xe9ges"),o.Sb(),o.Tb(9,"th"),o.Cc(10,"Rakt\xe1ron"),o.Sb(),o.Sb(),o.Sb(),o.Ac(11,H,2,1,"tbody",19),o.Sb(),o.Sb()),2&e){const e=o.ec();o.Bb(11),o.kc("ngIf",e.ingredientList)}}let q=(()=>{class e{constructor(e,t,i){this.mixingBatchesClient=e,this.router=t,this.modalService=i,this.mixingBatchMembersByOrderId=new Map,this.mixingBatchOrders=new Array,this.name="\xdaj kever\xe9s"}ngOnInit(){}orderSelected(e){e.member.items.some(e=>e.amount>0)?(this.mixingBatchMembersByOrderId.set(e.orderPart.order.id,e.member),this.mixingBatchOrders=[...this.mixingBatchOrders.filter(t=>t.orderPart.order.id!==e.orderPart.order.id),e]):(this.mixingBatchMembersByOrderId.delete(e.orderPart.order.id),this.mixingBatchOrders=this.mixingBatchOrders.filter(t=>t.orderPart.order.id!==e.orderPart.order.id))}save(){this.mixingBatchesClient.create(new r.o({name:this.name,members:this.mixingBatchOrders.map(e=>e.member)})).subscribe(e=>this.router.navigate(["/manufacturing","batch",e.id]))}openIngredientListModal(e){const t=new r.o({name:this.name,members:this.mixingBatchOrders.map(e=>e.member)});this.mixingBatchesClient.inventoryCheck(t).subscribe(t=>{this.ingredientList=t,this.ingredientListModal=this.modalService.show(e),this.ingredientListModal.onHide.subscribe(()=>this.ingredientList=void 0)})}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(r.n),o.Nb(n.b),o.Nb(s.a))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-create-manufacturing-batch"]],decls:20,vars:5,consts:[[1,"m-2","p-2"],[1,"d-flex","row","justify-content-end"],[1,"btn","btn-primary","mr-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"row","m-2"],["for","name"],["id","name","placeholder","Name","type","text",1,"form-control",3,"ngModel","ngModelChange"],["heading","Keres\xe9s"],["searchTab","tab"],[3,"mixingBatchMembersByOrderId","orderSelected",4,"ngIf"],["heading","Tartalom"],[3,"mixingBatchMembersByOrderId","mixingBatchOrders","orderSelected"],["heading","\xd6sszegz\xe9s"],[3,"mixingBatchOrders","orderSelected"],["ingredientListTemplate",""],[3,"mixingBatchMembersByOrderId","orderSelected"],[1,"modal-header"],[1,"modal-body"],[1,"table","text-dark"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",0),o.Tb(1,"div",1),o.Tb(2,"button",2),o.ac("click",function(){o.vc(e);const i=o.tc(19);return t.openIngredientListModal(i)}),o.Cc(3," Alapanyagok "),o.Sb(),o.Tb(4,"button",3),o.ac("click",function(){return t.save()}),o.Cc(5," Ment\xe9s "),o.Sb(),o.Sb(),o.Tb(6,"div",4),o.Tb(7,"label",5),o.Cc(8,"N\xe9v: "),o.Sb(),o.Tb(9,"input",6),o.ac("ngModelChange",function(e){return t.name=e}),o.Sb(),o.Sb(),o.Tb(10,"tabset"),o.Tb(11,"tab",7,8),o.Ac(13,U,1,1,"app-select-orders",9),o.Sb(),o.Tb(14,"tab",10),o.Tb(15,"app-batch-content",11),o.ac("orderSelected",function(e){return t.orderSelected(e)}),o.Sb(),o.Sb(),o.Tb(16,"tab",12),o.Tb(17,"app-batch-overview",13),o.ac("orderSelected",function(e){return t.orderSelected(e)}),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Ac(18,K,12,1,"ng-template",null,14,o.Bc)}if(2&e){const e=o.tc(12);o.Bb(9),o.kc("ngModel",t.name),o.Bb(4),o.kc("ngIf",e.active),o.Bb(2),o.kc("mixingBatchMembersByOrderId",t.mixingBatchMembersByOrderId)("mixingBatchOrders",t.mixingBatchOrders),o.Bb(2),o.kc("mixingBatchOrders",t.mixingBatchOrders)}},directives:[a.b,a.h,a.j,d.c,d.a,c.l,v,T,R,c.k,c.j],styles:[""]}),e})(),V=(()=>{class e{constructor(){this.measurement="adag"}ngOnInit(){}change(e){this.itemChanged.emit(this.item)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Hb({type:e,selectors:[["app-mixing-item"]],inputs:{item:"item"},outputs:{itemChanged:"itemChanged"},decls:11,vars:4,consts:[["type","secondary"],[1,"d-flex","w-100","justify-content-between"],[1,"d-flex","align-items-center","font-s"],[1,"h3","p-2","mb-0"],[1,"h4","p-2","mb-0"],[1,""],[3,"checked","checkedChange"]],template:function(e,t){1&e&&(o.Tb(0,"alert",0),o.Tb(1,"div",1),o.Tb(2,"div",2),o.Cc(3," K\xe9sz\xedts "),o.Tb(4,"span",3),o.Cc(5),o.Sb(),o.Cc(6),o.Tb(7,"span",4),o.Cc(8),o.Sb(),o.Sb(),o.Tb(9,"div",5),o.Tb(10,"app-add-check",6),o.ac("checkedChange",function(e){return t.item.completed=e})("checkedChange",function(e){return t.change(e)}),o.Sb(),o.Sb(),o.Sb(),o.Sb()),2&e&&(o.Bb(5),o.Ec(" ",t.item.amount," "),o.Bb(1),o.Ec(" ",t.measurement," "),o.Bb(2),o.Ec(" ",t.item.recipeName,""),o.Bb(2),o.kc("checked",t.item.completed))},directives:[N.a,h.a],styles:[""]}),e})();function J(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",2),o.Tb(1,"h2"),o.Cc(2),o.Sb(),o.Tb(3,"button",3),o.ac("click",function(){return o.vc(e),o.ec().onSave()}),o.Cc(4,"Ment\xe9s"),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Bb(2),o.Dc(e.batch.name)}}function X(e,t){if(1&e&&(o.Tb(0,"div"),o.Ob(1,"app-mixing-item",5),o.Sb()),2&e){const e=t.$implicit;o.Bb(1),o.kc("item",e)}}function Q(e,t){if(1&e&&(o.Tb(0,"div"),o.Ac(1,X,2,1,"div",4),o.Sb()),2&e){const e=o.ec();o.Bb(1),o.kc("ngForOf",e.items)}}function G(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",8),o.ac("click",function(){o.vc(e);const i=t.$implicit;return o.ec(2).select(i)}),o.Tb(1,"button",9),o.Cc(2),o.fc(3,"date"),o.Sb(),o.Sb()}if(2&e){const e=t.$implicit;o.Bb(2),o.Fc("",e.name," ",o.hc(3,2,e.created,"yyyy-MM-dd"),"")}}function W(e,t){if(1&e){const e=o.Ub();o.Rb(0,5),o.Tb(1,"cdk-virtual-scroll-viewport",6),o.ac("scrolledIndexChange",function(i){o.vc(e);const c=t.ngIf;return o.ec().nextBatch(i,c.length)}),o.Ac(2,G,4,5,"div",7),o.Sb(),o.Qb()}if(2&e){const e=t.ngIf;o.Bb(2),o.kc("cdkVirtualForOf",e)}}const Y=[{path:"create-batch",component:q},{path:"batch/:id",component:(()=>{class e{constructor(e,t){this.activatedRoute=e,this.mixingBatchClient=t,e.params.pipe(Object(x.a)(e=>t.get(e.id)),Object(I.a)(e=>this.batch=e),Object(I.a)(e=>this.mapToItems(e))).subscribe()}mapToItems(e){const t=new Map;e.members.forEach(e=>{e.items.forEach(e=>{if(!t.has(e.recipe.id)){t.set(e.recipe.id,{recipeId:e.recipe.id,recipeName:e.recipe.name,amount:0,completedAmount:0,completed:!1});const i=t.get(e.recipe.id);i.amount+=e.amount,i.completedAmount+=e.completedAmount,i.completed=e.completedAmount===i.amount}})}),this.items=[...t.values()]}ngOnInit(){}onSave(){this.save().subscribe()}save(){return this.mixingBatchClient.administerAbsolute(this.batch.id,this.batch.members.map(e=>new r.q({orderId:e.order.id,items:e.items.map(e=>new r.p({amount:this.items.find(t=>t.recipeId===e.recipe.id).completed?e.amount:0,recipeId:e.recipe.id}))}))).pipe()}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(n.a),o.Nb(r.n))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-mixing"]],decls:2,vars:2,consts:[["class","d-flex row justify-content-between m-2",4,"ngIf"],[4,"ngIf"],[1,"d-flex","row","justify-content-between","m-2"],[1,"btn","btn-success",3,"click"],[4,"ngFor","ngForOf"],[3,"item"]],template:function(e,t){1&e&&(o.Ac(0,J,5,1,"div",0),o.Ac(1,Q,2,1,"div",1)),2&e&&(o.kc("ngIf",t.batch),o.Bb(1),o.kc("ngIf",t.items))},directives:[c.l,c.k,V],styles:[""]}),e})()},{path:"batch",component:(()=>{class e{constructor(e,t){this.mixingBatchClient=e,this.router=t,this.batch=20,this.theEnd=!1,this.offset=new M.a(0),this.canAdd=!0,this.reset()}getBatch(e){return this.mixingBatchClient.list(e,this.batch).pipe(Object(I.a)(e=>this.theEnd=!e.hasMore),Object(O.a)(e=>e.content))}nextBatch(e,t){this.theEnd||this.viewport.getRenderedRange().end===this.viewport.getDataLength()&&this.offset.next(t)}ngOnInit(){}select(e){this.router.navigate(["/manufacturing","batch",e.id]).then()}onSearchTextChange(e){this.reset()}reset(){this.selectedItem=null;const e=this.offset.pipe(Object(y.a)(500),Object(x.b)(e=>this.getBatch(e)),Object(w.a)((e,t)=>e.concat(t),[]));this.items=e.pipe()}}return e.\u0275fac=function(t){return new(t||e)(o.Nb(r.n),o.Nb(n.b))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-mixing-list"]],viewQuery:function(e,t){if(1&e&&o.Jc(F.c,1),2&e){let e;o.sc(e=o.bc())&&(t.viewport=e.first)}},decls:6,vars:3,consts:[[1,"d-flex","row","flex-row-reverse","m-2"],[1,"col-lg-12","p-2"],[1,"card"],[1,"picklist-viewport","card","bg-light"],["class","picklist-viewport",4,"ngIf"],[1,"picklist-viewport"],["itemSize","50",1,"picklist-viewport",3,"scrolledIndexChange"],["class","example-item auto m-2",3,"click",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"example-item","auto","m-2",3,"click"],[1,"btn","btn-primary","w-100"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Tb(1,"div",1),o.Tb(2,"div",2),o.Tb(3,"div",3),o.Ac(4,W,3,1,"ng-container",4),o.fc(5,"async"),o.Sb(),o.Sb(),o.Sb(),o.Sb()),2&e&&(o.Bb(4),o.kc("ngIf",o.gc(5,1,t.items)))},directives:[c.l,F.c,F.a,F.b],pipes:[c.b,c.e],styles:[".picklist-viewport[_ngcontent-%COMP%]{height:90vh;width:100%}"]}),e})()}];var Z=i("6NWb"),_=i("PCNd");let ee=(()=>{class e{}return e.\u0275mod=o.Lb({type:e}),e.\u0275inj=o.Kb({factory:function(t){return new(t||e)},imports:[[c.c,n.e.forChild(Y),N.b,Z.c,d.b,_.a,a.f,F.d,F.d,F.d,F.d,F.d,F.d,F.d,F.d]]}),e})()}}]);