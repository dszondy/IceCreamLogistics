(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{G81l:function(e,t,i){"use strict";i.r(t),i.d(t,"ManufacturingModule",function(){return ee});var c=i("ofXK"),n=i("tyNb"),r=i("20UA"),s=i("fXoL"),o=i("K3ix"),d=i("3Pt+"),a=i("44PX");function b(e){return new r.p({orderId:e.order.id,items:[]})}class m{constructor(e,t){this.orderPart=e,this.member=t,this.clientName=e.order.client.name,this.incompleteItemsCount=e.incompleteItems.filter(e=>e.amount>0).length,this.memberItemsCount=(null==t?void 0:t.items.filter(e=>e.amount>0).length)||0,this.date=e.order.requestedDate.toLocaleDateString("hu-hu"),this.items=e.incompleteItems.map(e=>{var i;return{recipeId:e.recipe.id,recipeName:e.recipe.name,incompleteAmount:e.amount,memberAmount:(null===(i=null==t?void 0:t.items.find(t=>t.recipeId===e.recipe.id))||void 0===i?void 0:i.amount)||0}})}}var l=i("FrXe"),h=i("fU1k");function p(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",5),s.Sb(1,"div",6),s.yc(2),s.Rb(),s.Sb(3,"div",7),s.yc(4),s.Rb(),s.Sb(5,"div",7),s.Sb(6,"app-add-check",8),s.Zb("checkedChange",function(t){s.rc(e);const i=s.bc().$implicit;return s.bc().onOrderChecked(t,i)}),s.Rb(),s.Rb(),s.Rb()}if(2&e){const e=s.bc().$implicit;s.Bb(2),s.Bc("",e.clientName," (",e.date,")"),s.Bb(2),s.Bc("",e.memberItemsCount," / ",e.incompleteItemsCount,""),s.Bb(2),s.hc("checked",e.memberItemsCount>0)}}function u(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",5),s.Sb(1,"div",6),s.yc(2),s.Rb(),s.Sb(3,"div",7),s.yc(4),s.Rb(),s.Sb(5,"div",7),s.Sb(6,"app-add-check",8),s.Zb("checkedChange",function(i){s.rc(e);const c=t.$implicit,n=s.bc(2).$implicit;return s.bc().onItemChecked(i,c,n)}),s.Rb(),s.Rb(),s.Rb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Ac(" ",e.recipeName," "),s.Bb(2),s.Bc(" ",e.memberAmount," / ",e.incompleteAmount," "),s.Bb(2),s.hc("checked",e.memberAmount>0)}}function g(e,t){if(1&e&&s.wc(0,u,7,4,"div",9),2&e){const e=s.bc().$implicit,t=s.bc();s.hc("ngForOf",t.itemsFiltered(e))}}function f(e,t){1&e&&(s.Sb(0,"app-tree-node",2),s.wc(1,p,7,5,"ng-template",null,3,s.xc),s.wc(3,g,1,1,"ng-template",null,4,s.xc),s.Rb()),2&e&&s.hc("collapsed",!1)}let S=(()=>{class e{constructor(){this.mixingBatchMembersByOrderId=new Map,this.mixingBatchOrders=new Array,this.orderSelected=new s.n}ngOnInit(){}itemsFiltered(e){return e.items.filter(e=>e.memberAmount>0)}onItemChecked(e,t,i){i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId);const c=new m(i.orderPart,i.member);this.orderSelected.emit(c)}onOrderChecked(e,t){t.member=b(t.orderPart);const i=new m(t.orderPart,t.member);this.orderSelected.emit(i)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Gb({type:e,selectors:[["app-batch-content"]],inputs:{mixingBatchMembersByOrderId:"mixingBatchMembersByOrderId",mixingBatchOrders:"mixingBatchOrders"},outputs:{orderSelected:"orderSelected"},decls:2,vars:1,consts:[[1,"p-2"],[3,"collapsed",4,"ngFor","ngForOf"],[3,"collapsed"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-6"],[1,"col-3"],[3,"checked","checkedChange"],["class","row  align-items-center",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Sb(0,"div",0),s.wc(1,f,5,1,"app-tree-node",1),s.Rb()),2&e&&(s.Bb(1),s.hc("ngForOf",t.mixingBatchOrders))},directives:[c.k,l.a,h.a],styles:[""]}),e})();function v(e,t){if(1&e&&(s.Sb(0,"div",5),s.Sb(1,"div",6),s.yc(2),s.Rb(),s.Sb(3,"div",7),s.yc(4),s.Rb(),s.Sb(5,"div",7),s.yc(6),s.Rb(),s.Nb(7,"div",8),s.Rb()),2&e){const e=s.bc().$implicit;s.Bb(2),s.zc(e.recipeName),s.Bb(2),s.Ac("",e.totalAmount," adag"),s.Bb(2),s.Ac("",e.totalClients," megrendel\xe9sb\u0151l")}}function B(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",5),s.Sb(1,"div",6),s.yc(2),s.Rb(),s.Sb(3,"div",6),s.yc(4),s.Rb(),s.Sb(5,"div",10),s.Sb(6,"app-add-check",11),s.Zb("checkedChange",function(i){s.rc(e);const c=t.$implicit,n=s.bc(2).$implicit;return s.bc().onItemChecked(i,n.recipeId,c.order)}),s.Rb(),s.Rb(),s.Rb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Ac(" ",e.order.clientName," "),s.Bb(2),s.Ac(" ",e.item.memberAmount," adag"),s.Bb(2),s.hc("checked",!0)}}function y(e,t){if(1&e&&s.wc(0,B,7,3,"div",9),2&e){const e=s.bc().$implicit;s.hc("ngForOf",e.items)}}function R(e,t){1&e&&(s.Sb(0,"app-tree-node",2),s.wc(1,v,8,3,"ng-template",null,3,s.xc),s.wc(3,y,1,1,"ng-template",null,4,s.xc),s.Rb()),2&e&&s.hc("collapsed",!1)}let w=(()=>{class e{constructor(){this.orderSelected=new s.n,this.recipeDeselected=new s.n}set mixingBatchOrders(e){this.recipes=this.toInternalRepresentation(e)}toInternalRepresentation(e){const t=new Map;return e.forEach(e=>e.items.forEach(i=>{if(i.memberAmount>0)if(t.get(i.recipeId)){const c=t.get(i.recipeId);c.totalAmount+=i.memberAmount,c.totalClients+=1,c.items.push({item:e.items.find(e=>e.recipeId===i.recipeId),order:e})}else t.set(i.recipeId,{recipeName:i.recipeName,recipeId:i.recipeId,totalAmount:i.memberAmount,completedAmount:0,totalClients:1,items:[{item:e.items.find(e=>e.recipeId===i.recipeId),order:e}]})})),[...t.values()]}ngOnInit(){}onRecipeRemoved(e){this.recipeDeselected.emit(e)}onItemChecked(e,t,i){i.member.items=i.member.items.filter(e=>e.recipeId!==t);const c=new m(i.orderPart,i.member);this.orderSelected.emit(c)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Gb({type:e,selectors:[["app-batch-overview"]],inputs:{mixingBatchOrders:"mixingBatchOrders"},outputs:{orderSelected:"orderSelected",recipeDeselected:"recipeDeselected"},decls:2,vars:1,consts:[[1,"p-2"],[3,"collapsed",4,"ngFor","ngForOf"],[3,"collapsed"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-5"],[1,"col-3"],[1,"col-1"],["class","row  align-items-center",4,"ngFor","ngForOf"],[1,"col-2"],[3,"checked","checkedChange"]],template:function(e,t){1&e&&(s.Sb(0,"div",0),s.wc(1,R,5,1,"app-tree-node",1),s.Rb()),2&e&&(s.Bb(1),s.hc("ngForOf",t.recipes))},directives:[c.k,l.a,h.a],styles:[""]}),e})();var I=i("vkgz"),x=i("lJxs"),O=i("gcYM"),k=i("5+tZ"),C=i("Kqap"),M=i("2Vo4"),A=i("XNiG"),F=i("vxfF"),N=i("psEu");function j(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",17),s.Sb(1,"div",18),s.yc(2),s.Rb(),s.Sb(3,"div",19),s.yc(4),s.Rb(),s.Sb(5,"div",19),s.Sb(6,"app-add-check",20),s.Zb("checkedChange",function(t){s.rc(e);const i=s.bc().$implicit;return s.bc(2).onOrderChecked(t,i)}),s.Rb(),s.Rb(),s.Rb()}if(2&e){const e=s.bc().$implicit;s.Bb(2),s.Bc("",e.clientName," (",e.date,")"),s.Bb(2),s.Bc("",e.memberItemsCount," / ",e.incompleteItemsCount,""),s.Bb(2),s.hc("checked",e.memberItemsCount>0)}}function D(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",17),s.Sb(1,"div",18),s.yc(2),s.Rb(),s.Sb(3,"div",19),s.yc(4),s.Rb(),s.Sb(5,"div",19),s.Sb(6,"app-add-check",20),s.Zb("checkedChange",function(i){s.rc(e);const c=t.$implicit,n=s.bc(2).$implicit;return s.bc(2).onItemChecked(i,c,n)}),s.Rb(),s.Rb(),s.Rb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Ac(" ",e.recipeName," "),s.Bb(2),s.Bc(" ",e.memberAmount," / ",e.incompleteAmount," "),s.Bb(2),s.hc("checked",e.memberAmount>0)}}function P(e,t){if(1&e&&s.wc(0,D,7,4,"div",21),2&e){const e=s.bc().$implicit;s.hc("ngForOf",e.items)}}function Z(e,t){1&e&&(s.Sb(0,"app-tree-node"),s.wc(1,j,7,5,"ng-template",null,15,s.xc),s.wc(3,P,1,1,"ng-template",null,16,s.xc),s.Rb())}function $(e,t){if(1&e){const e=s.Tb();s.Qb(0,12),s.Sb(1,"cdk-virtual-scroll-viewport",13),s.Zb("scrolledIndexChange",function(i){s.rc(e);const c=t.ngIf;return s.bc().nextBatch(i,c.length)}),s.wc(2,Z,5,0,"app-tree-node",14),s.Rb(),s.Pb()}if(2&e){const e=t.ngIf;s.Bb(1),s.hc("itemSize",200),s.Bb(1),s.hc("cdkVirtualForOf",e)}}let T=(()=>{class e{constructor(e){this.ordersClient=e,this.batch=10,this.theEnd=!1,this.offset=new M.a(0),this.orderSelected=new s.n,this.itemsDisplayedSubject=new A.a,this.itemsDisplayedObservable=this.itemsDisplayedSubject.asObservable()}ngOnInit(){this.reset()}getBatch(e){return this.ordersClient.searchForMixing(this.from,this.to,this.clientName,this.recipeName,e,this.batch).pipe(Object(I.a)(e=>this.theEnd=!e.hasMore),Object(x.a)(e=>e.content.map(e=>new m(e,this.mixingBatchMembersByOrderId.get(e.order.id)))))}nextBatch(e,t){this.theEnd||this.viewport.getRenderedRange().end===this.viewport.getDataLength()&&this.offset.next(t)}filterChange(){this.reset()}onItemChecked(e,t,i){e?(i.member?i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId):i.member=b(i.orderPart),i.member.items.push(new r.o({recipeId:t.recipeId,amount:t.incompleteAmount}))):i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId);const c=new m(i.orderPart,i.member);this.itemsDisplayed[this.itemsDisplayed.indexOf(i)]=c,this.itemsDisplayedSubject.next([...this.itemsDisplayed]),this.orderSelected.emit(c)}onOrderChecked(e,t){var i;t.member=e?new r.p({orderId:(i=t.orderPart).order.id,items:i.incompleteItems.map(e=>new r.o({recipeId:e.recipe.id,amount:e.amount}))}):b(t.orderPart);const c=new m(t.orderPart,t.member);this.itemsDisplayed[this.itemsDisplayed.indexOf(t)]=c,this.itemsDisplayedSubject.next([...this.itemsDisplayed]),this.orderSelected.emit(c)}reset(){this.offset=new M.a(0),this.offset.pipe(Object(O.a)(500),Object(k.b)(e=>this.getBatch(e)),Object(C.a)((e,t)=>e.concat(t),[])).pipe(Object(I.a)(e=>this.itemsDisplayed=e),Object(I.a)(e=>this.itemsDisplayedSubject.next(e))).subscribe(),this.offset.next(0)}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(r.w))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-select-orders"]],viewQuery:function(e,t){if(1&e&&s.Fc(F.c,1),2&e){let e;s.oc(e=s.ac())&&(t.viewport=e.first)}},inputs:{mixingBatchMembersByOrderId:"mixingBatchMembersByOrderId",batchChanged:"batchChanged"},outputs:{orderSelected:"orderSelected"},decls:26,vars:13,consts:[["type","info"],[1,"form-group","col-lg-6"],["for","from",1,"form-label"],["id","from","type","date",1,"form-control",3,"ngModel","ngModelChange"],["for","to",1,"form-label"],["id","to","type","date",1,"form-control",3,"ngModel","ngModelChange"],["for","clientName",1,"form-label"],["id","clientName","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","recipeName",1,"form-label"],["id","recipeName","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"card","bg-primary","p-2"],["style","height: 80vh",4,"ngIf"],[2,"height","80vh"],[2,"height","80vh",3,"itemSize","scrolledIndexChange"],[4,"cdkVirtualFor","cdkVirtualForOf"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-6"],[1,"col-3"],[3,"checked","checkedChange"],["class","row  align-items-center",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Sb(0,"alert",0),s.yc(1,"Keres\xe9s kisz\xe1ll\xedt\xe1si d\xe1tum szerint t\xf3l/ig"),s.Nb(2,"br"),s.Sb(3,"div"),s.Sb(4,"div",1),s.Sb(5,"label",2),s.yc(6,"Kisz\xe1ll\xedt\xe1s d\xe1tuma: "),s.Rb(),s.Sb(7,"input",3),s.Zb("ngModelChange",function(e){return t.from=e,t.filterChange()}),s.cc(8,"date"),s.Rb(),s.Rb(),s.yc(9,"a "),s.Sb(10,"div",1),s.Sb(11,"label",4),s.yc(12," - "),s.Rb(),s.Sb(13,"input",5),s.Zb("ngModelChange",function(e){return t.to=e,t.filterChange()}),s.cc(14,"date"),s.Rb(),s.Rb(),s.Sb(15,"div",1),s.Sb(16,"label",6),s.yc(17," Fagyiz\xf3: "),s.Rb(),s.Sb(18,"input",7),s.Zb("ngModelChange",function(){return t.filterChange()})("ngModelChange",function(e){return t.clientName=e}),s.Rb(),s.Rb(),s.Sb(19,"div",1),s.Sb(20,"label",8),s.yc(21," Recept: "),s.Rb(),s.Sb(22,"input",9),s.Zb("ngModelChange",function(){return t.filterChange()})("ngModelChange",function(e){return t.recipeName=e}),s.Rb(),s.Rb(),s.Rb(),s.Rb(),s.Sb(23,"div",10),s.wc(24,$,3,2,"ng-container",11),s.cc(25,"async"),s.Rb()),2&e&&(s.Bb(7),s.hc("ngModel",s.ec(8,5,t.from,"yyyy-MM-dd")),s.Bb(6),s.hc("ngModel",s.ec(14,8,t.to,"yyyy-MM-dd")),s.Bb(5),s.hc("ngModel",t.clientName),s.Bb(4),s.hc("ngModel",t.recipeName),s.Bb(2),s.hc("ngIf",s.dc(25,11,t.itemsDisplayedObservable)))},directives:[N.a,d.b,d.h,d.j,c.l,F.c,F.a,F.b,l.a,h.a,c.k],pipes:[c.e,c.b],styles:[""]}),e})();function z(e,t){if(1&e){const e=s.Tb();s.Sb(0,"app-select-orders",15),s.Zb("orderSelected",function(t){return s.rc(e),s.bc().orderSelected(t)}),s.Rb()}if(2&e){const e=s.bc();s.hc("mixingBatchMembersByOrderId",e.mixingBatchMembersByOrderId)}}const L=function(e){return{"table-warning":e}};function E(e,t){if(1&e&&(s.Sb(0,"tr",21),s.Sb(1,"td"),s.yc(2),s.Rb(),s.Sb(3,"td"),s.yc(4),s.Rb(),s.Sb(5,"td"),s.yc(6),s.Rb(),s.Rb()),2&e){const e=t.$implicit;s.hc("ngClass",s.kc(6,L,e.amountRequired!==e.ingredient.amountOnHand)),s.Bb(2),s.zc(e.ingredient.name),s.Bb(2),s.Bc("",e.amountRequired," ",e.ingredient.measurementUnit,""),s.Bb(2),s.Bc("",e.ingredient.amountOnHand," ",e.ingredient.measurementUnit,"")}}function G(e,t){if(1&e&&(s.Sb(0,"tbody"),s.wc(1,E,7,8,"tr",20),s.Rb()),2&e){const e=s.bc(2);s.Bb(1),s.hc("ngForOf",e.ingredientList)}}function K(e,t){if(1&e&&(s.Nb(0,"div",16),s.Sb(1,"div",17),s.Sb(2,"table",18),s.Sb(3,"thead"),s.Sb(4,"tr"),s.Sb(5,"th"),s.yc(6,"Alapanyag"),s.Rb(),s.Sb(7,"th"),s.yc(8,"Sz\xfcks\xe9ges"),s.Rb(),s.Sb(9,"th"),s.yc(10,"Rakt\xe1ron"),s.Rb(),s.Rb(),s.Rb(),s.wc(11,G,2,1,"tbody",19),s.Rb(),s.Rb()),2&e){const e=s.bc();s.Bb(11),s.hc("ngIf",e.ingredientList)}}let V=(()=>{class e{constructor(e,t,i){this.mixingBatchesClient=e,this.router=t,this.modalService=i,this.mixingBatchMembersByOrderId=new Map,this.mixingBatchOrders=new Array,this.name="\xdaj kever\xe9s"}ngOnInit(){}orderSelected(e){e.member.items.some(e=>e.amount>0)?(this.mixingBatchMembersByOrderId.set(e.orderPart.order.id,e.member),this.mixingBatchOrders=[...this.mixingBatchOrders.filter(t=>t.orderPart.order.id!==e.orderPart.order.id),e]):(this.mixingBatchMembersByOrderId.delete(e.orderPart.order.id),this.mixingBatchOrders=this.mixingBatchOrders.filter(t=>t.orderPart.order.id!==e.orderPart.order.id))}save(){this.mixingBatchesClient.create(new r.n({name:this.name,members:this.mixingBatchOrders.map(e=>e.member)})).subscribe(e=>this.router.navigate(["/manufacturing","batch",e.id]))}openIngredientListModal(e){const t=new r.n({name:this.name,members:this.mixingBatchOrders.map(e=>e.member)});this.mixingBatchesClient.inventoryCheck(t).subscribe(t=>{this.ingredientList=t,this.ingredientListModal=this.modalService.show(e),this.ingredientListModal.onHide.subscribe(()=>this.ingredientList=void 0)})}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(r.m),s.Mb(n.b),s.Mb(o.a))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-create-manufacturing-batch"]],decls:20,vars:5,consts:[[1,"m-2","p-2"],[1,"d-flex","row","justify-content-end"],[1,"btn","btn-primary","mr-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"row","m-2"],["for","name"],["id","name","placeholder","Name","type","text",1,"form-control",3,"ngModel","ngModelChange"],["heading","Keres\xe9s"],["searchTab","tab"],[3,"mixingBatchMembersByOrderId","orderSelected",4,"ngIf"],["heading","Tartalom"],[3,"mixingBatchMembersByOrderId","mixingBatchOrders","orderSelected"],["heading","\xd6sszegz\xe9s"],[3,"mixingBatchOrders","orderSelected"],["ingredientListTemplate",""],[3,"mixingBatchMembersByOrderId","orderSelected"],[1,"modal-header"],[1,"modal-body"],[1,"table","text-dark"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",0),s.Sb(1,"div",1),s.Sb(2,"button",2),s.Zb("click",function(){s.rc(e);const i=s.pc(19);return t.openIngredientListModal(i)}),s.yc(3," Alapanyagok "),s.Rb(),s.Sb(4,"button",3),s.Zb("click",function(){return t.save()}),s.yc(5," Ment\xe9s "),s.Rb(),s.Rb(),s.Sb(6,"div",4),s.Sb(7,"label",5),s.yc(8,"N\xe9v: "),s.Rb(),s.Sb(9,"input",6),s.Zb("ngModelChange",function(e){return t.name=e}),s.Rb(),s.Rb(),s.Sb(10,"tabset"),s.Sb(11,"tab",7,8),s.wc(13,z,1,1,"app-select-orders",9),s.Rb(),s.Sb(14,"tab",10),s.Sb(15,"app-batch-content",11),s.Zb("orderSelected",function(e){return t.orderSelected(e)}),s.Rb(),s.Rb(),s.Sb(16,"tab",12),s.Sb(17,"app-batch-overview",13),s.Zb("orderSelected",function(e){return t.orderSelected(e)}),s.Rb(),s.Rb(),s.Rb(),s.Rb(),s.wc(18,K,12,1,"ng-template",null,14,s.xc)}if(2&e){const e=s.pc(12);s.Bb(9),s.hc("ngModel",t.name),s.Bb(4),s.hc("ngIf",e.active),s.Bb(2),s.hc("mixingBatchMembersByOrderId",t.mixingBatchMembersByOrderId)("mixingBatchOrders",t.mixingBatchOrders),s.Bb(2),s.hc("mixingBatchOrders",t.mixingBatchOrders)}},directives:[d.b,d.h,d.j,a.c,a.a,c.l,S,w,T,c.k,c.j],styles:[""]}),e})(),X=(()=>{class e{constructor(){this.measurement="adag"}ngOnInit(){}change(e){this.itemChanged.emit(this.item)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Gb({type:e,selectors:[["app-mixing-item"]],inputs:{item:"item"},outputs:{itemChanged:"itemChanged"},decls:11,vars:4,consts:[["type","secondary"],[1,"d-flex","w-100","justify-content-between"],[1,"d-flex","align-items-center","font-s"],[1,"h3","p-2","mb-0"],[1,"h4","p-2","mb-0"],[1,""],[3,"checked","checkedChange"]],template:function(e,t){1&e&&(s.Sb(0,"alert",0),s.Sb(1,"div",1),s.Sb(2,"div",2),s.yc(3," K\xe9sz\xedts "),s.Sb(4,"span",3),s.yc(5),s.Rb(),s.yc(6),s.Sb(7,"span",4),s.yc(8),s.Rb(),s.Rb(),s.Sb(9,"div",5),s.Sb(10,"app-add-check",6),s.Zb("checkedChange",function(e){return t.item.completed=e})("checkedChange",function(e){return t.change(e)}),s.Rb(),s.Rb(),s.Rb(),s.Rb()),2&e&&(s.Bb(5),s.Ac(" ",t.item.amount," "),s.Bb(1),s.Ac(" ",t.measurement," "),s.Bb(2),s.Ac(" ",t.item.recipeName,""),s.Bb(2),s.hc("checked",t.item.completed))},directives:[N.a,h.a],styles:[""]}),e})();function q(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",2),s.Sb(1,"h2"),s.yc(2),s.Rb(),s.Sb(3,"button",3),s.Zb("click",function(){return s.rc(e),s.bc().onSave()}),s.yc(4,"Ment\xe9s"),s.Rb(),s.Rb()}if(2&e){const e=s.bc();s.Bb(2),s.zc(e.batch.name)}}function J(e,t){if(1&e&&(s.Sb(0,"div"),s.Nb(1,"app-mixing-item",5),s.Rb()),2&e){const e=t.$implicit;s.Bb(1),s.hc("item",e)}}function Q(e,t){if(1&e&&(s.Sb(0,"div"),s.wc(1,J,2,1,"div",4),s.Rb()),2&e){const e=s.bc();s.Bb(1),s.hc("ngForOf",e.items)}}function U(e,t){if(1&e){const e=s.Tb();s.Sb(0,"div",8),s.Zb("click",function(){s.rc(e);const i=t.$implicit;return s.bc(2).select(i)}),s.Sb(1,"button",9),s.yc(2),s.Rb(),s.Rb()}if(2&e){const e=t.$implicit;s.Bb(2),s.zc(e.name)}}function H(e,t){if(1&e){const e=s.Tb();s.Qb(0,5),s.Sb(1,"cdk-virtual-scroll-viewport",6),s.Zb("scrolledIndexChange",function(i){s.rc(e);const c=t.ngIf;return s.bc().nextBatch(i,c.length)}),s.wc(2,U,3,1,"div",7),s.Rb(),s.Pb()}if(2&e){const e=t.ngIf;s.Bb(2),s.hc("cdkVirtualForOf",e)}}const W=[{path:"create-batch",component:V},{path:"batch/:id",component:(()=>{class e{constructor(e,t){this.activatedRoute=e,this.mixingBatchClient=t,e.params.pipe(Object(k.a)(e=>t.get(e.id)),Object(I.a)(e=>this.batch=e),Object(I.a)(e=>this.mapToItems(e))).subscribe()}mapToItems(e){const t=new Map;e.members.forEach(e=>{e.items.forEach(e=>{if(!t.has(e.recipe.id)){t.set(e.recipe.id,{recipeId:e.recipe.id,recipeName:e.recipe.name,amount:0,completedAmount:0,completed:!1});const i=t.get(e.recipe.id);i.amount+=e.amount,i.completedAmount+=e.completedAmount,i.completed=e.completedAmount===i.amount}})}),this.items=[...t.values()]}ngOnInit(){}onSave(){this.save().subscribe()}save(){return this.mixingBatchClient.administerAbsolute(this.batch.id,this.batch.members.map(e=>new r.p({orderId:e.order.id,items:e.items.map(e=>new r.o({amount:this.items.find(t=>t.recipeId===e.recipe.id).completed?e.amount:0,recipeId:e.recipe.id}))}))).pipe()}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(n.a),s.Mb(r.m))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-mixing"]],decls:2,vars:2,consts:[["class","d-flex row justify-content-between m-2",4,"ngIf"],[4,"ngIf"],[1,"d-flex","row","justify-content-between","m-2"],[1,"btn","btn-success",3,"click"],[4,"ngFor","ngForOf"],[3,"item"]],template:function(e,t){1&e&&(s.wc(0,q,5,1,"div",0),s.wc(1,Q,2,1,"div",1)),2&e&&(s.hc("ngIf",t.batch),s.Bb(1),s.hc("ngIf",t.items))},directives:[c.l,c.k,X],styles:[""]}),e})()},{path:"batch",component:(()=>{class e{constructor(e,t){this.mixingBatchClient=e,this.router=t,this.batch=20,this.theEnd=!1,this.offset=new M.a(0),this.canAdd=!0,this.reset()}getBatch(e){return this.mixingBatchClient.list(e,this.batch).pipe(Object(I.a)(e=>this.theEnd=!e.hasMore),Object(x.a)(e=>e.content))}nextBatch(e,t){this.theEnd||this.viewport.getRenderedRange().end===this.viewport.getDataLength()&&this.offset.next(t)}ngOnInit(){}select(e){this.router.navigate(["/manufacturing","batch",e.id]).then()}onSearchTextChange(e){this.reset()}reset(){this.selectedItem=null;const e=this.offset.pipe(Object(O.a)(500),Object(k.b)(e=>this.getBatch(e)),Object(C.a)((e,t)=>e.concat(t),[]));this.items=e.pipe()}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(r.m),s.Mb(n.b))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-mixing-list"]],viewQuery:function(e,t){if(1&e&&s.Fc(F.c,1),2&e){let e;s.oc(e=s.ac())&&(t.viewport=e.first)}},decls:6,vars:3,consts:[[1,"d-flex","row","flex-row-reverse","m-2"],[1,"col-lg-12","p-2"],[1,"card"],[1,"picklist-viewport","card","bg-light"],["class","picklist-viewport",4,"ngIf"],[1,"picklist-viewport"],["itemSize","50",1,"picklist-viewport",3,"scrolledIndexChange"],["class","example-item auto m-1",3,"click",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"example-item","auto","m-1",3,"click"],[1,"btn","btn-primary","w-100"]],template:function(e,t){1&e&&(s.Sb(0,"div",0),s.Sb(1,"div",1),s.Sb(2,"div",2),s.Sb(3,"div",3),s.wc(4,H,3,1,"ng-container",4),s.cc(5,"async"),s.Rb(),s.Rb(),s.Rb(),s.Rb()),2&e&&(s.Bb(4),s.hc("ngIf",s.dc(5,1,t.items)))},directives:[c.l,F.c,F.a,F.b],pipes:[c.b],styles:[".picklist-viewport[_ngcontent-%COMP%]{height:90vh;width:100%}"]}),e})()}];var Y=i("6NWb"),_=i("PCNd");let ee=(()=>{class e{}return e.\u0275mod=s.Kb({type:e}),e.\u0275inj=s.Jb({factory:function(t){return new(t||e)},imports:[[c.c,n.e.forChild(W),N.b,Y.c,a.b,_.a,d.f,F.d,F.d,F.d,F.d,F.d,F.d,F.d,F.d]]}),e})()}}]);