(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{G81l:function(e,t,i){"use strict";i.r(t),i.d(t,"ManufacturingModule",function(){return ee});var c=i("ofXK"),n=i("tyNb"),r=i("20UA"),s=i("fXoL"),o=i("K3ix"),a=i("3Pt+"),d=i("44PX");function m(e){return new r.q({orderId:e.order.id,items:[]})}class b{constructor(e,t){this.orderPart=e,this.member=t,this.clientName=e.order.client.name,this.incompleteItemsCount=e.incompleteItems.filter(e=>e.amount>0).length,this.memberItemsCount=(null==t?void 0:t.items.filter(e=>e.amount>0).length)||0,this.date=e.order.requestedDate.toLocaleDateString("hu-hu"),this.items=e.incompleteItems.map(e=>{var i;return{recipeId:e.recipe.id,recipeName:e.recipe.name,incompleteAmount:e.amount,memberAmount:(null===(i=null==t?void 0:t.items.find(t=>t.recipeId===e.recipe.id))||void 0===i?void 0:i.amount)||0}})}}var l=i("FrXe"),h=i("fU1k");function p(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",5),s.Tb(1,"div",6),s.Cc(2),s.Sb(),s.Tb(3,"div",7),s.Cc(4),s.Sb(),s.Tb(5,"div",8),s.Tb(6,"app-add-check",9),s.ac("checkedChange",function(t){s.vc(e);const i=s.ec().$implicit;return s.ec().onOrderChecked(t,i)}),s.Sb(),s.Sb(),s.Sb()}if(2&e){const e=s.ec().$implicit;s.Bb(2),s.Fc("",e.clientName," (",e.date,")"),s.Bb(2),s.Fc("",e.memberItemsCount," / ",e.incompleteItemsCount,""),s.Bb(2),s.kc("checked",e.memberItemsCount>0)}}function u(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",5),s.Tb(1,"div",6),s.Cc(2),s.Sb(),s.Tb(3,"div",11),s.Tb(4,"input",12),s.ac("ngModelChange",function(e){return t.$implicit.memberAmount=e})("ngModelChange",function(){s.vc(e);const t=s.ec(2).$implicit;return s.ec().change(t)}),s.Sb(),s.Sb(),s.Tb(5,"div",13),s.Cc(6),s.Sb(),s.Tb(7,"div",8),s.Tb(8,"app-add-check",9),s.ac("checkedChange",function(i){s.vc(e);const c=t.$implicit,n=s.ec(2).$implicit;return s.ec().onItemChecked(i,c,n)}),s.Sb(),s.Sb(),s.Sb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Ec(" ",e.recipeName," "),s.Bb(2),s.kc("ngModel",e.memberAmount)("max",e.incompleteAmount),s.Bb(2),s.Ec("/",e.incompleteAmount,""),s.Bb(2),s.kc("checked",e.memberAmount>0)}}function g(e,t){if(1&e&&s.Ac(0,u,9,5,"div",10),2&e){const e=s.ec().$implicit,t=s.ec();s.kc("ngForOf",t.itemsFiltered(e))}}function f(e,t){1&e&&(s.Tb(0,"app-tree-node",2),s.Ac(1,p,7,5,"ng-template",null,3,s.Bc),s.Ac(3,g,1,1,"ng-template",null,4,s.Bc),s.Sb()),2&e&&s.kc("collapsed",!1)}let v=(()=>{class e{constructor(){this.mixingBatchMembersByOrderId=new Map,this.mixingBatchOrders=new Array,this.orderSelected=new s.n}ngOnInit(){}itemsFiltered(e){return e.items.filter(e=>e.memberAmount>0)}onItemChecked(e,t,i){i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId);const c=new b(i.orderPart,i.member);this.orderSelected.emit(c)}onOrderChecked(e,t){t.member=m(t.orderPart);const i=new b(t.orderPart,t.member);this.orderSelected.emit(i)}change(e){e.member.items.forEach(t=>t.amount=e.items.find(e=>e.recipeId==t.recipeId).memberAmount),this.orderSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Hb({type:e,selectors:[["app-batch-content"]],inputs:{mixingBatchMembersByOrderId:"mixingBatchMembersByOrderId",mixingBatchOrders:"mixingBatchOrders"},outputs:{orderSelected:"orderSelected"},decls:2,vars:1,consts:[[1,"p-2"],[3,"collapsed",4,"ngFor","ngForOf"],[3,"collapsed"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-6"],[1,"col-4"],[1,"col-2"],[3,"checked","checkedChange"],["class","row  align-items-center",4,"ngFor","ngForOf"],[1,"col-3"],["width","20rem","min","1",1,"form-control",3,"ngModel","max","ngModelChange"],[1,"col-1"]],template:function(e,t){1&e&&(s.Tb(0,"div",0),s.Ac(1,f,5,1,"app-tree-node",1),s.Sb()),2&e&&(s.Bb(1),s.kc("ngForOf",t.mixingBatchOrders))},directives:[c.k,l.a,h.a,a.b,a.h,a.j],styles:[""]}),e})();function S(e,t){if(1&e&&(s.Tb(0,"div",5),s.Tb(1,"div",6),s.Cc(2),s.Sb(),s.Tb(3,"div",7),s.Cc(4),s.Sb(),s.Tb(5,"div",7),s.Cc(6),s.Sb(),s.Ob(7,"div",8),s.Sb()),2&e){const e=s.ec().$implicit;s.Bb(2),s.Dc(e.recipeName),s.Bb(2),s.Ec("",e.totalAmount," adag"),s.Bb(2),s.Ec("",e.totalClients," megrendel\xe9sb\u0151l")}}function B(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",5),s.Tb(1,"div",6),s.Cc(2),s.Sb(),s.Tb(3,"div",6),s.Cc(4),s.Sb(),s.Tb(5,"div",10),s.Tb(6,"app-add-check",11),s.ac("checkedChange",function(i){s.vc(e);const c=t.$implicit,n=s.ec(2).$implicit;return s.ec().onItemChecked(i,n.recipeId,c.order)}),s.Sb(),s.Sb(),s.Sb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Ec(" ",e.order.clientName," "),s.Bb(2),s.Ec(" ",e.item.memberAmount," adag"),s.Bb(2),s.kc("checked",!0)}}function C(e,t){if(1&e&&s.Ac(0,B,7,3,"div",9),2&e){const e=s.ec().$implicit;s.kc("ngForOf",e.items)}}function k(e,t){1&e&&(s.Tb(0,"app-tree-node",2),s.Ac(1,S,8,3,"ng-template",null,3,s.Bc),s.Ac(3,C,1,1,"ng-template",null,4,s.Bc),s.Sb()),2&e&&s.kc("collapsed",!1)}let T=(()=>{class e{constructor(){this.orderSelected=new s.n,this.recipeDeselected=new s.n}set mixingBatchOrders(e){this.recipes=this.toInternalRepresentation(e)}toInternalRepresentation(e){const t=new Map;return e.forEach(e=>e.items.forEach(i=>{if(i.memberAmount>0)if(t.get(i.recipeId)){const c=t.get(i.recipeId);c.totalAmount+=i.memberAmount,c.totalClients+=1,c.items.push({item:e.items.find(e=>e.recipeId===i.recipeId),order:e})}else t.set(i.recipeId,{recipeName:i.recipeName,recipeId:i.recipeId,totalAmount:i.memberAmount,completedAmount:0,totalClients:1,items:[{item:e.items.find(e=>e.recipeId===i.recipeId),order:e}]})})),[...t.values()]}ngOnInit(){}onRecipeRemoved(e){this.recipeDeselected.emit(e)}onItemChecked(e,t,i){i.member.items=i.member.items.filter(e=>e.recipeId!==t);const c=new b(i.orderPart,i.member);this.orderSelected.emit(c)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Hb({type:e,selectors:[["app-batch-overview"]],inputs:{mixingBatchOrders:"mixingBatchOrders"},outputs:{orderSelected:"orderSelected",recipeDeselected:"recipeDeselected"},decls:2,vars:1,consts:[[1,"p-2"],[3,"collapsed",4,"ngFor","ngForOf"],[3,"collapsed"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-5"],[1,"col-3"],[1,"col-1"],["class","row  align-items-center",4,"ngFor","ngForOf"],[1,"col-2"],[3,"checked","checkedChange"]],template:function(e,t){1&e&&(s.Tb(0,"div",0),s.Ac(1,k,5,1,"app-tree-node",1),s.Sb()),2&e&&(s.Bb(1),s.kc("ngForOf",t.recipes))},directives:[c.k,l.a,h.a],styles:[""]}),e})();var I=i("vkgz"),O=i("lJxs"),y=i("gcYM"),x=i("5+tZ"),w=i("Kqap"),M=i("2Vo4"),A=i("XNiG"),F=i("vxfF"),N=i("psEu");function j(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",17),s.Tb(1,"div",18),s.Cc(2),s.Sb(),s.Tb(3,"div",19),s.Cc(4),s.Sb(),s.Tb(5,"div",19),s.Tb(6,"app-add-check",20),s.ac("checkedChange",function(t){s.vc(e);const i=s.ec().$implicit;return s.ec(2).onOrderChecked(t,i)}),s.Sb(),s.Sb(),s.Sb()}if(2&e){const e=s.ec().$implicit;s.Bb(2),s.Fc("",e.clientName," (",e.date,")"),s.Bb(2),s.Fc("",e.memberItemsCount," / ",e.incompleteItemsCount,""),s.Bb(2),s.kc("checked",e.memberItemsCount>0)}}function D(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",17),s.Tb(1,"div",18),s.Cc(2),s.Sb(),s.Tb(3,"div",19),s.Cc(4),s.Sb(),s.Tb(5,"div",19),s.Tb(6,"app-add-check",20),s.ac("checkedChange",function(i){s.vc(e);const c=t.$implicit,n=s.ec(2).$implicit;return s.ec(2).onItemChecked(i,c,n)}),s.Sb(),s.Sb(),s.Sb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Ec(" ",e.recipeName," "),s.Bb(2),s.Fc(" ",e.memberAmount," / ",e.incompleteAmount," "),s.Bb(2),s.kc("checked",e.memberAmount>0)}}function $(e,t){if(1&e&&s.Ac(0,D,7,4,"div",21),2&e){const e=s.ec().$implicit;s.kc("ngForOf",e.items)}}function E(e,t){1&e&&(s.Tb(0,"app-tree-node"),s.Ac(1,j,7,5,"ng-template",null,15,s.Bc),s.Ac(3,$,1,1,"ng-template",null,16,s.Bc),s.Sb())}function P(e,t){if(1&e){const e=s.Ub();s.Rb(0,12),s.Tb(1,"cdk-virtual-scroll-viewport",13),s.ac("scrolledIndexChange",function(i){s.vc(e);const c=t.ngIf;return s.ec().nextBatch(i,c.length)}),s.Ac(2,E,5,0,"app-tree-node",14),s.Sb(),s.Qb()}if(2&e){const e=t.ngIf;s.Bb(1),s.kc("itemSize",200),s.Bb(1),s.kc("cdkVirtualForOf",e)}}let R=(()=>{class e{constructor(e){this.ordersClient=e,this.batch=10,this.theEnd=!1,this.offset=new M.a(0),this.orderSelected=new s.n,this.itemsDisplayedSubject=new A.a,this.itemsDisplayedObservable=this.itemsDisplayedSubject.asObservable()}ngOnInit(){this.reset()}getBatch(e){return this.ordersClient.searchForMixing(this.from,this.to,this.clientName,this.recipeName,e,this.batch).pipe(Object(I.a)(e=>this.theEnd=!e.hasMore),Object(O.a)(e=>e.content.map(e=>new b(e,this.mixingBatchMembersByOrderId.get(e.order.id)))))}nextBatch(e,t){this.theEnd||this.viewport.getRenderedRange().end===this.viewport.getDataLength()&&this.offset.next(t)}filterChange(){this.reset()}onItemChecked(e,t,i){e?(i.member?i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId):i.member=m(i.orderPart),i.member.items.push(new r.p({recipeId:t.recipeId,amount:t.incompleteAmount}))):i.member.items=i.member.items.filter(e=>e.recipeId!==t.recipeId);const c=new b(i.orderPart,i.member);this.itemsDisplayed[this.itemsDisplayed.indexOf(i)]=c,this.itemsDisplayedSubject.next([...this.itemsDisplayed]),this.orderSelected.emit(c)}onOrderChecked(e,t){var i;t.member=e?new r.q({orderId:(i=t.orderPart).order.id,items:i.incompleteItems.map(e=>new r.p({recipeId:e.recipe.id,amount:e.amount}))}):m(t.orderPart);const c=new b(t.orderPart,t.member);this.itemsDisplayed[this.itemsDisplayed.indexOf(t)]=c,this.itemsDisplayedSubject.next([...this.itemsDisplayed]),this.orderSelected.emit(c)}reset(){this.offset=new M.a(0),this.offset.pipe(Object(y.a)(500),Object(x.b)(e=>this.getBatch(e)),Object(w.a)((e,t)=>e.concat(t),[])).pipe(Object(I.a)(e=>this.itemsDisplayed=e),Object(I.a)(e=>this.itemsDisplayedSubject.next(e))).subscribe(),this.offset.next(0)}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(r.y))},e.\u0275cmp=s.Hb({type:e,selectors:[["app-select-orders"]],viewQuery:function(e,t){if(1&e&&s.Jc(F.c,1),2&e){let e;s.sc(e=s.bc())&&(t.viewport=e.first)}},inputs:{mixingBatchMembersByOrderId:"mixingBatchMembersByOrderId",batchChanged:"batchChanged"},outputs:{orderSelected:"orderSelected"},decls:26,vars:13,consts:[["type","info"],[1,"form-group","col-lg-6"],["for","from",1,"form-label"],["id","from","type","date",1,"form-control",3,"ngModel","ngModelChange"],["for","to",1,"form-label"],["id","to","type","date",1,"form-control",3,"ngModel","ngModelChange"],["for","clientName",1,"form-label"],["id","clientName","type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","recipeName",1,"form-label"],["id","recipeName","type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"card","bg-primary","p-2"],["style","height: 80vh",4,"ngIf"],[2,"height","80vh"],[2,"height","80vh",3,"itemSize","scrolledIndexChange"],[4,"cdkVirtualFor","cdkVirtualForOf"],["head",""],["content",""],[1,"row","align-items-center"],[1,"col-6"],[1,"col-3"],[3,"checked","checkedChange"],["class","row  align-items-center",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(s.Tb(0,"alert",0),s.Cc(1,"Keres\xe9s kisz\xe1ll\xedt\xe1si d\xe1tum szerint t\xf3l/ig"),s.Ob(2,"br"),s.Tb(3,"div"),s.Tb(4,"div",1),s.Tb(5,"label",2),s.Cc(6,"Kisz\xe1ll\xedt\xe1s d\xe1tuma: "),s.Sb(),s.Tb(7,"input",3),s.ac("ngModelChange",function(e){return t.from=e,t.filterChange()}),s.fc(8,"date"),s.Sb(),s.Sb(),s.Cc(9,"a "),s.Tb(10,"div",1),s.Tb(11,"label",4),s.Cc(12," - "),s.Sb(),s.Tb(13,"input",5),s.ac("ngModelChange",function(e){return t.to=e,t.filterChange()}),s.fc(14,"date"),s.Sb(),s.Sb(),s.Tb(15,"div",1),s.Tb(16,"label",6),s.Cc(17," Fagyiz\xf3: "),s.Sb(),s.Tb(18,"input",7),s.ac("ngModelChange",function(){return t.filterChange()})("ngModelChange",function(e){return t.clientName=e}),s.Sb(),s.Sb(),s.Tb(19,"div",1),s.Tb(20,"label",8),s.Cc(21," Recept: "),s.Sb(),s.Tb(22,"input",9),s.ac("ngModelChange",function(){return t.filterChange()})("ngModelChange",function(e){return t.recipeName=e}),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Tb(23,"div",10),s.Ac(24,P,3,2,"ng-container",11),s.fc(25,"async"),s.Sb()),2&e&&(s.Bb(7),s.kc("ngModel",s.hc(8,5,t.from,"yyyy-MM-dd")),s.Bb(6),s.kc("ngModel",s.hc(14,8,t.to,"yyyy-MM-dd")),s.Bb(5),s.kc("ngModel",t.clientName),s.Bb(4),s.kc("ngModel",t.recipeName),s.Bb(2),s.kc("ngIf",s.gc(25,11,t.itemsDisplayedObservable)))},directives:[N.a,a.b,a.h,a.j,c.l,F.c,F.a,F.b,l.a,h.a,c.k],pipes:[c.e,c.b],styles:[""]}),e})();function U(e,t){if(1&e){const e=s.Ub();s.Tb(0,"app-select-orders",15),s.ac("orderSelected",function(t){return s.vc(e),s.ec().orderSelected(t)}),s.Sb()}if(2&e){const e=s.ec();s.kc("mixingBatchMembersByOrderId",e.mixingBatchMembersByOrderId)}}const L=function(e){return{"table-warning":e}};function z(e,t){if(1&e&&(s.Tb(0,"tr",21),s.Tb(1,"td"),s.Cc(2),s.Sb(),s.Tb(3,"td"),s.Cc(4),s.Sb(),s.Tb(5,"td"),s.Cc(6),s.Sb(),s.Sb()),2&e){const e=t.$implicit;s.kc("ngClass",s.oc(6,L,e.amountRequired!==e.ingredient.amountOnHand)),s.Bb(2),s.Dc(e.ingredient.name),s.Bb(2),s.Fc("",e.amountRequired," ",e.ingredient.measurementUnit,""),s.Bb(2),s.Fc("",e.ingredient.amountOnHand," ",e.ingredient.measurementUnit,"")}}function H(e,t){if(1&e&&(s.Tb(0,"tbody"),s.Ac(1,z,7,8,"tr",20),s.Sb()),2&e){const e=s.ec(2);s.Bb(1),s.kc("ngForOf",e.ingredientList)}}function K(e,t){if(1&e&&(s.Ob(0,"div",16),s.Tb(1,"div",17),s.Tb(2,"table",18),s.Tb(3,"thead"),s.Tb(4,"tr"),s.Tb(5,"th"),s.Cc(6,"Alapanyag"),s.Sb(),s.Tb(7,"th"),s.Cc(8,"Sz\xfcks\xe9ges"),s.Sb(),s.Tb(9,"th"),s.Cc(10,"Rakt\xe1ron"),s.Sb(),s.Sb(),s.Sb(),s.Ac(11,H,2,1,"tbody",19),s.Sb(),s.Sb()),2&e){const e=s.ec();s.Bb(11),s.kc("ngIf",e.ingredientList)}}let q=(()=>{class e{constructor(e,t,i){this.mixingBatchesClient=e,this.router=t,this.modalService=i,this.mixingBatchMembersByOrderId=new Map,this.mixingBatchOrders=new Array,this.name="\xdaj kever\xe9s"}ngOnInit(){}orderSelected(e){e.member.items.some(e=>e.amount>0)?(this.mixingBatchMembersByOrderId.set(e.orderPart.order.id,e.member),this.mixingBatchOrders=[...this.mixingBatchOrders.filter(t=>t.orderPart.order.id!==e.orderPart.order.id),e]):(this.mixingBatchMembersByOrderId.delete(e.orderPart.order.id),this.mixingBatchOrders=this.mixingBatchOrders.filter(t=>t.orderPart.order.id!==e.orderPart.order.id))}save(){this.mixingBatchesClient.create(new r.o({name:this.name,members:this.mixingBatchOrders.map(e=>e.member)})).subscribe(e=>this.router.navigate(["/manufacturing","batch",e.id]))}openIngredientListModal(e){const t=new r.o({name:this.name,members:this.mixingBatchOrders.map(e=>e.member)});this.mixingBatchesClient.inventoryCheck(t).subscribe(t=>{this.ingredientList=t,this.ingredientListModal=this.modalService.show(e),this.ingredientListModal.onHide.subscribe(()=>this.ingredientList=void 0)})}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(r.n),s.Nb(n.b),s.Nb(o.a))},e.\u0275cmp=s.Hb({type:e,selectors:[["app-create-manufacturing-batch"]],decls:20,vars:5,consts:[[1,"m-2","p-2"],[1,"d-flex","row","justify-content-end"],[1,"btn","btn-primary","mr-2",3,"click"],[1,"btn","btn-success",3,"click"],[1,"row","m-2"],["for","name"],["id","name","placeholder","Name","type","text",1,"form-control",3,"ngModel","ngModelChange"],["heading","Keres\xe9s"],["searchTab","tab"],[3,"mixingBatchMembersByOrderId","orderSelected",4,"ngIf"],["heading","Tartalom"],[3,"mixingBatchMembersByOrderId","mixingBatchOrders","orderSelected"],["heading","\xd6sszegz\xe9s"],[3,"mixingBatchOrders","orderSelected"],["ingredientListTemplate",""],[3,"mixingBatchMembersByOrderId","orderSelected"],[1,"modal-header"],[1,"modal-body"],[1,"table","text-dark"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"button",2),s.ac("click",function(){s.vc(e);const i=s.tc(19);return t.openIngredientListModal(i)}),s.Cc(3," Alapanyagok "),s.Sb(),s.Tb(4,"button",3),s.ac("click",function(){return t.save()}),s.Cc(5," Ment\xe9s "),s.Sb(),s.Sb(),s.Tb(6,"div",4),s.Tb(7,"label",5),s.Cc(8,"N\xe9v: "),s.Sb(),s.Tb(9,"input",6),s.ac("ngModelChange",function(e){return t.name=e}),s.Sb(),s.Sb(),s.Tb(10,"tabset"),s.Tb(11,"tab",7,8),s.Ac(13,U,1,1,"app-select-orders",9),s.Sb(),s.Tb(14,"tab",10),s.Tb(15,"app-batch-content",11),s.ac("orderSelected",function(e){return t.orderSelected(e)}),s.Sb(),s.Sb(),s.Tb(16,"tab",12),s.Tb(17,"app-batch-overview",13),s.ac("orderSelected",function(e){return t.orderSelected(e)}),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Ac(18,K,12,1,"ng-template",null,14,s.Bc)}if(2&e){const e=s.tc(12);s.Bb(9),s.kc("ngModel",t.name),s.Bb(4),s.kc("ngIf",e.active),s.Bb(2),s.kc("mixingBatchMembersByOrderId",t.mixingBatchMembersByOrderId)("mixingBatchOrders",t.mixingBatchOrders),s.Bb(2),s.kc("mixingBatchOrders",t.mixingBatchOrders)}},directives:[a.b,a.h,a.j,d.c,d.a,c.l,v,T,R,c.k,c.j],styles:[""]}),e})(),V=(()=>{class e{constructor(){this.measurement="adag"}ngOnInit(){}change(e){this.itemChanged.emit(this.item)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Hb({type:e,selectors:[["app-mixing-item"]],inputs:{item:"item"},outputs:{itemChanged:"itemChanged"},decls:11,vars:4,consts:[["type","secondary"],[1,"d-flex","w-100","justify-content-between"],[1,"d-flex","align-items-center","font-s"],[1,"h3","p-2","mb-0"],[1,"h4","p-2","mb-0"],[1,""],[3,"checked","checkedChange"]],template:function(e,t){1&e&&(s.Tb(0,"alert",0),s.Tb(1,"div",1),s.Tb(2,"div",2),s.Cc(3," K\xe9sz\xedts "),s.Tb(4,"span",3),s.Cc(5),s.Sb(),s.Cc(6),s.Tb(7,"span",4),s.Cc(8),s.Sb(),s.Sb(),s.Tb(9,"div",5),s.Tb(10,"app-add-check",6),s.ac("checkedChange",function(e){return t.item.completed=e})("checkedChange",function(e){return t.change(e)}),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&e&&(s.Bb(5),s.Ec(" ",t.item.amount," "),s.Bb(1),s.Ec(" ",t.measurement," "),s.Bb(2),s.Ec(" ",t.item.recipeName,""),s.Bb(2),s.kc("checked",t.item.completed))},directives:[N.a,h.a],styles:[""]}),e})();function J(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",2),s.Tb(1,"h2"),s.Cc(2),s.Sb(),s.Tb(3,"button",3),s.ac("click",function(){return s.vc(e),s.ec().onSave()}),s.Cc(4,"Ment\xe9s"),s.Sb(),s.Sb()}if(2&e){const e=s.ec();s.Bb(2),s.Dc(e.batch.name)}}function X(e,t){if(1&e&&(s.Tb(0,"div"),s.Ob(1,"app-mixing-item",5),s.Sb()),2&e){const e=t.$implicit;s.Bb(1),s.kc("item",e)}}function Q(e,t){if(1&e&&(s.Tb(0,"div"),s.Ac(1,X,2,1,"div",4),s.Sb()),2&e){const e=s.ec();s.Bb(1),s.kc("ngForOf",e.items)}}function G(e,t){if(1&e){const e=s.Ub();s.Tb(0,"div",8),s.ac("click",function(){s.vc(e);const i=t.$implicit;return s.ec(2).select(i)}),s.Tb(1,"button",9),s.Cc(2),s.fc(3,"date"),s.Sb(),s.Sb()}if(2&e){const e=t.$implicit;s.Bb(2),s.Fc("",e.name," ",s.hc(3,2,e.created,"yyyy-MM-dd"),"")}}function W(e,t){if(1&e){const e=s.Ub();s.Rb(0,5),s.Tb(1,"cdk-virtual-scroll-viewport",6),s.ac("scrolledIndexChange",function(i){s.vc(e);const c=t.ngIf;return s.ec().nextBatch(i,c.length)}),s.Ac(2,G,4,5,"div",7),s.Sb(),s.Qb()}if(2&e){const e=t.ngIf;s.Bb(2),s.kc("cdkVirtualForOf",e)}}const Y=[{path:"create-batch",component:q},{path:"batch/:id",component:(()=>{class e{constructor(e,t){this.activatedRoute=e,this.mixingBatchClient=t,e.params.pipe(Object(x.a)(e=>t.get(e.id)),Object(I.a)(e=>this.batch=e),Object(I.a)(e=>this.mapToItems(e))).subscribe()}mapToItems(e){const t=new Map;e.members.forEach(e=>{e.items.forEach(e=>{if(!t.has(e.recipe.id)){t.set(e.recipe.id,{recipeId:e.recipe.id,recipeName:e.recipe.name,amount:0,completedAmount:0,completed:!1});const i=t.get(e.recipe.id);i.amount+=e.amount,i.completedAmount+=e.completedAmount,i.completed=e.completedAmount===i.amount}})}),this.items=[...t.values()]}ngOnInit(){}onSave(){this.save().subscribe()}save(){return this.mixingBatchClient.administerAbsolute(this.batch.id,this.batch.members.map(e=>new r.q({orderId:e.order.id,items:e.items.map(e=>new r.p({amount:this.items.find(t=>t.recipeId===e.recipe.id).completed?e.amount:0,recipeId:e.recipe.id}))}))).pipe()}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(n.a),s.Nb(r.n))},e.\u0275cmp=s.Hb({type:e,selectors:[["app-mixing"]],decls:2,vars:2,consts:[["class","d-flex row justify-content-between m-2",4,"ngIf"],[4,"ngIf"],[1,"d-flex","row","justify-content-between","m-2"],[1,"btn","btn-success",3,"click"],[4,"ngFor","ngForOf"],[3,"item"]],template:function(e,t){1&e&&(s.Ac(0,J,5,1,"div",0),s.Ac(1,Q,2,1,"div",1)),2&e&&(s.kc("ngIf",t.batch),s.Bb(1),s.kc("ngIf",t.items))},directives:[c.l,c.k,V],styles:[""]}),e})()},{path:"batch",component:(()=>{class e{constructor(e,t){this.mixingBatchClient=e,this.router=t,this.batch=20,this.theEnd=!1,this.offset=new M.a(0),this.canAdd=!0,this.reset()}getBatch(e){return this.mixingBatchClient.list(e,this.batch).pipe(Object(I.a)(e=>this.theEnd=!e.hasMore),Object(O.a)(e=>e.content))}nextBatch(e,t){this.theEnd||this.viewport.getRenderedRange().end===this.viewport.getDataLength()&&this.offset.next(t)}ngOnInit(){}select(e){this.router.navigate(["/manufacturing","batch",e.id]).then()}onSearchTextChange(e){this.reset()}reset(){this.selectedItem=null;const e=this.offset.pipe(Object(y.a)(500),Object(x.b)(e=>this.getBatch(e)),Object(w.a)((e,t)=>e.concat(t),[]));this.items=e.pipe()}}return e.\u0275fac=function(t){return new(t||e)(s.Nb(r.n),s.Nb(n.b))},e.\u0275cmp=s.Hb({type:e,selectors:[["app-mixing-list"]],viewQuery:function(e,t){if(1&e&&s.Jc(F.c,1),2&e){let e;s.sc(e=s.bc())&&(t.viewport=e.first)}},decls:6,vars:3,consts:[[1,"d-flex","row","flex-row-reverse","m-2"],[1,"col-lg-12","p-2"],[1,"card"],[1,"picklist-viewport","card","bg-light"],["class","picklist-viewport",4,"ngIf"],[1,"picklist-viewport"],["itemSize","50",1,"picklist-viewport",3,"scrolledIndexChange"],["class","example-item auto m-2",3,"click",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"example-item","auto","m-2",3,"click"],[1,"btn","btn-primary","w-100"]],template:function(e,t){1&e&&(s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"div",2),s.Tb(3,"div",3),s.Ac(4,W,3,1,"ng-container",4),s.fc(5,"async"),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&e&&(s.Bb(4),s.kc("ngIf",s.gc(5,1,t.items)))},directives:[c.l,F.c,F.a,F.b],pipes:[c.b,c.e],styles:[".picklist-viewport[_ngcontent-%COMP%]{height:90vh;width:100%}"]}),e})()}];var Z=i("6NWb"),_=i("PCNd");let ee=(()=>{class e{}return e.\u0275mod=s.Lb({type:e}),e.\u0275inj=s.Kb({factory:function(t){return new(t||e)},imports:[[c.c,n.e.forChild(Y),N.b,Z.c,d.b,_.a,a.f,F.d,F.d,F.d,F.d,F.d,F.d,F.d,F.d]]}),e})()}}]);